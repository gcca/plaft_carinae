'use strict';(function(g){var w,x,s,y,z,A,B,C,D,E,F,G,H,I,e={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(b){return!b||/^\s*$/.test(b)},escapeRegExChars:function(b){return b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(b){return"string"===typeof b},isNumber:function(b){return"number"===typeof b},isArray:g.isArray,isFunction:g.isFunction,isObject:g.isPlainObject,isUndefined:function(b){return"undefined"===
typeof b},bind:g.proxy,each:function(b,e){g.each(b,function(b,d){return e(d,b)})},map:g.map,filter:g.grep,every:function(b,e){var f=!0;if(!b)return f;g.each(b,function(d,a){if(!(f=e.call(null,a,d,b)))return!1});return!!f},some:function(b,e){var f=!1;if(!b)return f;g.each(b,function(d,a){if(f=e.call(null,a,d,b))return!1});return!!f},mixin:g.extend,getUniqueId:function(){var b=0;return function(){return b++}}(),templatify:function(b){function e(){return String(b)}return g.isFunction(b)?b:e},defer:function(b){setTimeout(b,
0)},debounce:function(b,e,f){var d,a;return function(){var c=this,h=arguments,l;l=f&&!d;clearTimeout(d);d=setTimeout(function(){d=null;f||(a=b.apply(c,h))},e);l&&(a=b.apply(c,h));return a}},throttle:function(b,e){var f,d,a,c,h,l;h=0;l=function(){h=new Date;a=null;c=b.apply(f,d)};return function(){var p=new Date,m=e-(p-h);f=this;d=arguments;0>=m?(clearTimeout(a),a=null,h=p,c=b.apply(f,d)):a||(a=setTimeout(l,m));return c}},noop:function(){}},O=function(b){function e(a){return a.split(/\s+/)}function f(a){return a.split(/\W+/)}
function d(a){return function(c){return function(h){return a(h[c])}}}return{nonword:f,whitespace:e,obj:{nonword:d(f),whitespace:d(e)}}}(),J=function(){function b(d){this.maxSize=d||100;this.size=0;this.hash={};this.list=new g}function g(){this.head=this.tail=null}function f(d,a){this.key=d;this.val=a;this.prev=this.next=null}e.mixin(b.prototype,{set:function(d,a){var c=this.list.tail;this.size>=this.maxSize&&(this.list.remove(c),delete this.hash[c.key]);(c=this.hash[d])?(c.val=a,this.list.moveToFront(c)):
(c=new f(d,a),this.list.add(c),this.hash[d]=c,this.size++)},get:function(d){if(d=this.hash[d])return this.list.moveToFront(d),d.val}});e.mixin(g.prototype,{add:function(d){this.head&&(d.next=this.head,this.head.prev=d);this.head=d;this.tail=this.tail||d},remove:function(d){d.prev?d.prev.next=d.next:this.head=d.next;d.next?d.next.prev=d.prev:this.tail=d.prev},moveToFront:function(d){this.remove(d);this.add(d)}});return b}(),P=function(){function b(a){this.prefix=["__",a,"__"].join("");this.ttlKey=
"__ttl__";this.keyMatcher=RegExp("^"+this.prefix)}function g(a){return JSON.stringify(e.isUndefined(a)?null:a)}var f;try{f=window.localStorage,f.setItem("~~~","!"),f.removeItem("~~~")}catch(d){f=null}e.mixin(b.prototype,f&&window.JSON?{_prefix:function(a){return this.prefix+a},_ttlKey:function(a){return this._prefix(a)+this.ttlKey},get:function(a){this.isExpired(a)&&this.remove(a);a=f.getItem(this._prefix(a));return JSON.parse(a)},set:function(a,c,h){e.isNumber(h)?f.setItem(this._ttlKey(a),g((new Date).getTime()+
h)):f.removeItem(this._ttlKey(a));return f.setItem(this._prefix(a),g(c))},remove:function(a){f.removeItem(this._ttlKey(a));f.removeItem(this._prefix(a));return this},clear:function(){var a,c,h=[],l=f.length;for(a=0;a<l;a++)(c=f.key(a)).match(this.keyMatcher)&&h.push(c.replace(this.keyMatcher,""));for(a=h.length;a--;)this.remove(h[a]);return this},isExpired:function(a){a=f.getItem(this._ttlKey(a));a=JSON.parse(a);return e.isNumber(a)&&(new Date).getTime()>a?!0:!1}}:{get:e.noop,set:e.noop,remove:e.noop,
clear:e.noop,isExpired:e.noop});return b}(),L=function(){function b(c){c=c||{};this._send=c.transport?k(c.transport):g.ajax;this._get=c.rateLimiter?c.rateLimiter(this._get):this._get}function k(c){return function(a,d){var b=g.Deferred();c(a,d,function(c){e.defer(function(){b.resolve(c)})},function(c){e.defer(function(){b.reject(c)})});return b}}var f=0,d={},a=6,c=new J(10);b.setMaxPendingRequests=function(c){a=c};b.resetCache=function(){c=new J(10)};e.mixin(b.prototype,{_get:function(h,l,b){function e(a){b&&
b(null,a);c.set(h,a)}function g(){b&&b(!0)}function k(){f--;delete d[h];q.onDeckRequestArgs&&(q._get.apply(q,q.onDeckRequestArgs),q.onDeckRequestArgs=null)}var q=this,K;(K=d[h])?K.done(e).fail(g):f<a?(f++,d[h]=this._send(h,l).done(e).fail(g).always(k)):this.onDeckRequestArgs=[].slice.call(arguments,0)},get:function(a,l,d){var b;e.isFunction(l)&&(d=l,l={});(b=c.get(a))?e.defer(function(){d&&d(null,b)}):this._get(a,l,d);return!!b}});return b}(),Q=function(){function b(a){a=a||{};a.datumTokenizer&&a.queryTokenizer||
g.error("datumTokenizer and queryTokenizer are both required");this.datumTokenizer=a.datumTokenizer;this.queryTokenizer=a.queryTokenizer;this.reset()}function k(a){a=e.filter(a,function(c){return!!c});return a=e.map(a,function(c){return c.toLowerCase()})}function f(a){for(var c={},h=[],l=0;l<a.length;l++)c[a[l]]||(c[a[l]]=!0,h.push(a[l]));return h}function d(a,c){function h(c,a){return c-a}var l=0,d=0,b=[];a=a.sort(h);for(c=c.sort(h);l<a.length&&d<c.length;)a[l]<c[d]?l++:(a[l]>c[d]||(b.push(a[l]),
l++),d++);return b}e.mixin(b.prototype,{bootstrap:function(a){this.datums=a.datums;this.trie=a.trie},add:function(a){var c=this;a=e.isArray(a)?a:[a];e.each(a,function(a){var l;l=c.datums.push(a)-1;a=k(c.datumTokenizer(a));e.each(a,function(a){var h,d;h=c.trie;for(a=a.split("");d=a.shift();)h=h.children[d]||(h.children[d]={ids:[],children:{}}),h.ids.push(l)})})},get:function(a){var c=this,h;a=k(this.queryTokenizer(a));e.each(a,function(a){var b,f;if(h&&0===h.length)return!1;b=c.trie;for(a=a.split("");b&&
(f=a.shift());)b=b.children[f];if(b&&0===a.length)b=b.ids.slice(0),h=h?d(h,b):b;else return h=[],!1});return h?e.map(f(h),function(a){return c.datums[a]}):[]},reset:function(){this.datums=[];this.trie={ids:[],children:{}}},serialize:function(){return{datums:this.datums,trie:this.trie}}});return b}(),u=function(){return{local:function(b){return b.local||null},prefetch:function(b){var k;k={url:null,thumbprint:"",ttl:864E5,filter:null,ajax:{}};if(b=b.prefetch||null)b=e.isString(b)?{url:b}:b,b=e.mixin(k,
b),b.thumbprint="0.10.2"+b.thumbprint,b.ajax.type=b.ajax.type||"GET",b.ajax.dataType=b.ajax.dataType||"json",!b.url&&g.error("prefetch requires url to be set");return b},remote:function(b){function k(a){return function(c){return e.debounce(c,a)}}function f(a){return function(c){return e.throttle(c,a)}}var d;d={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}};if(b=b.remote||null)b=e.isString(b)?{url:b}:b,b=e.mixin(d,b),b.rateLimiter=/^throttle$/i.test(b.rateLimitBy)?
f(b.rateLimitWait):k(b.rateLimitWait),b.ajax.type=b.ajax.type||"GET",b.ajax.dataType=b.ajax.dataType||"json",delete b.rateLimitBy,delete b.rateLimitWait,!b.url&&g.error("remote requires url to be set");return b}}}();(function(b){function k(c){c&&(c.local||c.prefetch||c.remote)||g.error("one of local, prefetch, or remote is required");this.limit=c.limit||5;this.sorter=f(c.sorter);this.dupDetector=c.dupDetector||d;this.local=u.local(c);this.prefetch=u.prefetch(c);this.remote=u.remote(c);this.cacheKey=
this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null;this.index=new Q({datumTokenizer:c.datumTokenizer,queryTokenizer:c.queryTokenizer});this.storage=this.cacheKey?new P(this.cacheKey):null}function f(c){function a(h){return h.sort(c)}function d(c){return c}return e.isFunction(c)?a:d}function d(){return!1}var a;a=b.Bloodhound;b.Bloodhound=k;k.noConflict=function(){b.Bloodhound=a;return k};k.tokenizers=O;e.mixin(k.prototype,{_loadPrefetch:function(c){function a(h){d.clear();d.add(c.filter?
c.filter(h):h);d._saveToStorage(d.index.serialize(),c.thumbprint,c.ttl)}var d=this,b;(b=this._readFromStorage(c.thumbprint))?(this.index.bootstrap(b),b=g.Deferred().resolve()):b=g.ajax(c.url,c.ajax).done(a);return b},_getFromRemote:function(c,a){var d=this,b;c=c||"";b=encodeURIComponent(c);b=this.remote.replace?this.remote.replace(this.remote.url,c):this.remote.url.replace(this.remote.wildcard,b);return this.transport.get(b,this.remote.ajax,function(c,b){c?a([]):a(d.remote.filter?d.remote.filter(b):
b)})},_saveToStorage:function(c,a,d){this.storage&&(this.storage.set("data",c,d),this.storage.set("protocol",location.protocol,d),this.storage.set("thumbprint",a,d))},_readFromStorage:function(c){var a,d,b;this.storage&&(a=this.storage.get("data"),d=this.storage.get("protocol"),b=this.storage.get("thumbprint"));c=b!==c||d!==location.protocol;return a&&!c?a:null},_initialize:function(){function c(){a.add(e.isFunction(d)?d():d)}var a=this,d=this.local,b;b=this.prefetch?this._loadPrefetch(this.prefetch):
g.Deferred().resolve();d&&b.done(c);this.transport=this.remote?new L(this.remote):null;return this.initPromise=b.promise()},initialize:function(c){return!this.initPromise||c?this._initialize():this.initPromise},add:function(c){this.index.add(c)},get:function(c,a){function d(c){var l=f.slice(0);e.each(c,function(c){!e.some(l,function(a){return b.dupDetector(c,a)})&&l.push(c);return l.length<b.limit});a&&a(b.sorter(l))}var b=this,f=[],g=!1,f=this.index.get(c),f=this.sorter(f).slice(0,this.limit);f.length<
this.limit&&this.transport&&(g=this._getFromRemote(c,d));g||(0<f.length||!this.transport)&&a&&a(f)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&L.resetCache()},ttAdapter:function(){return e.bind(this.get,this)}});return k})(this);E='<span class="twitter-Am"></span>';F='<span class="Wl-Mc-Vi"></span>';G='<div class="Wl-Yl-%CLASS%"></div>';H='<span class="Wl-Xl"></span>';I='<div class="Wl-Dm"></div>';
w={position:"relative",width:"100%",display:"inline-block"};x={position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"};s={position:"relative",verticalAlign:"top"};y={position:"relative",verticalAlign:"top"};z={position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"};A={display:"block"};B={whiteSpace:"normal"};C={left:"0",right:"auto"};D={left:"auto",right:" 0"};e.isMsie()&&e.mixin(s,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"});
e.isMsie()&&7>=e.isMsie()&&e.mixin(s,{marginTop:"-1px"});var M=function(){function b(b){b&&b.el||g.error("EventBus initialized without el");this.$el=g(b.el)}e.mixin(b.prototype,{trigger:function(b){var f=[].slice.call(arguments,1);this.$el.trigger("typeahead:"+b,f)}});return b}(),v=function(){function b(c,a,b,e){if(!b)return this;a=a.split(d);b=e?f(b,e):b;for(this._callbacks=this._callbacks||{};e=a.shift();)this._callbacks[e]=this._callbacks[e]||{sync:[],async:[]},this._callbacks[e][c].push(b);return this}
function e(c,a,b){return function(){for(var d,f=0;!d&&f<c.length;f+=1)d=!1===c[f].apply(a,b);return!d}}function f(c,a){return c.bind?c.bind(a):function(){c.apply(a,[].slice.call(arguments,0))}}var d=/\s+/,a=function(){return window.setImmediate?function(c){setImmediate(function(){c()})}:function(c){setTimeout(function(){c()},0)}}();return{onSync:function(c,a,d){return b.call(this,"sync",c,a,d)},onAsync:function(c,a,d){return b.call(this,"async",c,a,d)},off:function(c){var a;if(!this._callbacks)return this;
for(c=c.split(d);a=c.shift();)delete this._callbacks[a];return this},trigger:function(c){var b,f,g,m,r;if(!this._callbacks)return this;c=c.split(d);for(g=[].slice.call(arguments,1);(b=c.shift())&&(f=this._callbacks[b]);)m=e(f.sync,this,[b].concat(g)),r=e(f.async,this,[b].concat(g)),m()&&a(r);return this}}}(),R=function(b){function g(b,a,c){for(var h=[],f=0;f<b.length;f++)h.push(e.escapeRegExChars(b[f]));b=c?"\\b("+h.join("|")+")\\b":"("+h.join("|")+")";return a?RegExp(b):RegExp(b,"i")}var f={node:null,
pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(d){function a(a){var c,f;if(c=h.exec(a.data))wrapperNode=b.createElement(d.tagName),d.className&&(wrapperNode.className=d.className),f=a.splitText(c.index),f.splitText(c[0].length),wrapperNode.appendChild(f.cloneNode(!0)),a.parentNode.replaceChild(wrapperNode,f);return!!c}function c(a,b){for(var d,h=0;h<a.childNodes.length;h++)d=a.childNodes[h],3===d.nodeType?h+=b(d)?1:0:c(d,b)}var h;d=e.mixin({},f,d);d.node&&
d.pattern&&(d.pattern=e.isArray(d.pattern)?d.pattern:[d.pattern],h=g(d.pattern,d.caseSensitive,d.wordsOnly),c(d.node,a))}}(window.document),N=function(){function b(a){var c=this,b,f,p,m;a=a||{};a.input||g.error("input is missing");b=e.bind(this._onBlur,this);f=e.bind(this._onFocus,this);p=e.bind(this._onKeydown,this);m=e.bind(this._onInput,this);this.$hint=g(a.hint);this.$input=g(a.input).on("blur.tt",b).on("focus.tt",f).on("keydown.tt",p);0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=
this.clearHintIfInvalid=e.noop);if(e.isMsie())this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(a){d[a.which||a.keyCode]||e.defer(e.bind(c._onInput,c,a))});else this.$input.on("input.tt",m);this.query=this.$input.val();this.$overflowHelper=k(this.$input)}function k(a){return g('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:a.css("font-family"),fontSize:a.css("font-size"),fontStyle:a.css("font-style"),fontVariant:a.css("font-variant"),
fontWeight:a.css("font-weight"),wordSpacing:a.css("word-spacing"),letterSpacing:a.css("letter-spacing"),textIndent:a.css("text-indent"),textRendering:a.css("text-rendering"),textTransform:a.css("text-transform")}).insertAfter(a)}function f(a){return a.altKey||a.ctrlKey||a.metaKey||a.shiftKey}var d;d={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};b.normalizeQuery=function(a){return(a||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")};e.mixin(b.prototype,v,{_onBlur:function(){this.resetInputValue();
this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(a){var c=d[a.which||a.keyCode];this._managePreventDefault(c,a);c&&this._shouldTrigger(c,a)&&this.trigger(c+"Keyed",a)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(a,c){var b,d;switch(a){case "tab":b=this.getHint();d=this.getInputValue();b=b&&b!==d&&!f(c);break;case "up":case "down":b=!f(c);break;default:b=!1}b&&c.preventDefault()},_shouldTrigger:function(a,c){var b;switch(a){case "tab":b=
!f(c);break;default:b=!0}return b},_checkInputValue:function(){var a,c,d;a=this.getInputValue();c=this.query;d=(c=b.normalizeQuery(a)===b.normalizeQuery(c))?this.query.length!==a.length:!1;c?d&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query=a)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(a){this.query=a},getInputValue:function(){return this.$input.val()},setInputValue:function(a,
c){this.$input.val(a);c?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(a){this.$hint.val(a)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var a,c;a=this.getInputValue();c=this.getHint();c=a!==c&&0===c.indexOf(a);""!==a&&c&&!this.hasOverflow()||this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var a=
this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=a},isCursorAtEnd:function(){var a,c;a=this.$input.val().length;c=this.$input[0].selectionStart;return e.isNumber(c)?c===a:document.selection?(c=document.selection.createRange(),c.moveStart("character",-a),a===c.text.length):!0},destroy:function(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null}});return b}(),t=function(){function b(a){a=a||{};a.templates=
a.templates||{};a.source||g.error("missing source");a.name&&!/^[_a-zA-Z0-9-]+$/.test(a.name)&&g.error("invalid dataset name: "+a.name);this.query=null;this.highlight=!!a.highlight;this.name=a.name||e.getUniqueId();this.source=a.source;this.displayFn=k(a.display||a.displayKey);this.templates=f(a.templates,this.displayFn);this.$el=g(G.replace("%CLASS%",this.name))}function k(a){function c(b){return b[a]}a=a||"value";return e.isFunction(a)?a:c}function f(a,c){function b(a){return"<p>"+c(a)+"</p>"}return{empty:a.empty&&
e.templatify(a.empty),header:a.header&&e.templatify(a.header),footer:a.footer&&e.templatify(a.footer),suggestion:a.suggestion||b}}var d="ttDataset",a="ttValue",c="ttDatum";b.extractDatasetName=function(a){return g(a).data(d)};b.extractValue=function(c){return g(c).data(a)};b.extractDatum=function(a){return g(a).data(c)};e.mixin(b.prototype,v,{_render:function(b,f){function k(){var p,m;p=g(H).css(A);m=e.map(f,function(b){b=g(I).append(n.templates.suggestion(b)).data(d,n.name).data(a,n.displayFn(b)).data(c,
b);b.children().each(function(){g(this).css(B)});return b});p.append.apply(p,m);n.highlight&&R({node:p[0],pattern:b});return p}function m(){return n.templates.header({query:b,isEmpty:!q})}function r(){return n.templates.footer({query:b,isEmpty:!q})}if(this.$el){var n=this,q;this.$el.empty();q=f&&f.length;!q&&this.templates.empty?this.$el.html(n.templates.empty({query:b,isEmpty:!0})).prepend(n.templates.header?m():null).append(n.templates.footer?r():null):q&&this.$el.html(k()).prepend(n.templates.header?
m():null).append(n.templates.footer?r():null);this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(a){var c=this;this.query=a;this.canceled=!1;this.source(a,function(b){c.canceled||a!==c.query||c._render(a,b)})},cancel:function(){this.canceled=!0},clear:function(){this.cancel();this.$el.empty();this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}});return b}(),S=function(){function b(b){var d=this,a,c,h;b=b||{};b.menu||
g.error("menu is required");this.isOpen=!1;this.isEmpty=!0;this.datasets=e.map(b.datasets,k);a=e.bind(this._onSuggestionClick,this);c=e.bind(this._onSuggestionMouseEnter,this);h=e.bind(this._onSuggestionMouseLeave,this);this.$menu=g(b.menu).on("click.tt",".Wl-Dm",a).on("mouseenter.tt",".Wl-Dm",c).on("mouseleave.tt",".Wl-Dm",h);e.each(this.datasets,function(a){d.$menu.append(a.getRoot());a.onSync("rendered",d._onRendered,d)})}function k(b){return new t(b)}e.mixin(b.prototype,v,{_onSuggestionClick:function(b){this.trigger("suggestionClicked",
g(b.currentTarget))},_onSuggestionMouseEnter:function(b){this._removeCursor();this._setCursor(g(b.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){(this.isEmpty=e.every(this.datasets,function(b){return b.isEmpty()}))?this._hide():this.isOpen&&this._show();this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".Wl-Dm")},_getCursor:function(){return this.$menu.find(".Wl-Em").first()},
_setCursor:function(b,d){b.first().addClass("Wl-Em");!d&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("Wl-Em")},_moveCursor:function(b){var d,a;this.isOpen&&(a=this._getCursor(),d=this._getSuggestions(),this._removeCursor(),b=d.index(a)+b,b=(b+1)%(d.length+1)-1,-1===b?this.trigger("cursorRemoved"):(-1>b&&(b=d.length-1),this._setCursor(d=d.eq(b)),this._ensureVisible(d)))},_ensureVisible:function(b){var d,a,c;d=b.position().top;b=d+b.outerHeight(!0);a=this.$menu.scrollTop();
c=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10);0>d?this.$menu.scrollTop(a+d):c<b&&this.$menu.scrollTop(a+(b-c))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(b){this.$menu.css("ltr"===b?C:D)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},
getDatumForSuggestion:function(b){var d=null;b.length&&(d={raw:t.extractDatum(b),value:t.extractValue(b),datasetName:t.extractDatasetName(b)});return d},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(b){e.each(this.datasets,function(d){d.update(b)})},empty:function(){e.each(this.datasets,function(b){b.clear()});this.isEmpty=!0},isVisible:function(){return this.isOpen&&
!this.isEmpty},destroy:function(){this.$menu.off(".tt");this.$menu=null;e.each(this.datasets,function(b){b.destroy()})}});return b}(),T=function(){function b(a){var b,d,f;a=a||{};a.input||g.error("missing input");this.isActivated=!1;this.autoselect=!!a.autoselect;this.minLength=e.isNumber(a.minLength)?a.minLength:1;this.$node=k(a.input,a.withHint);b=this.$node.find(".Wl-Mc-Vi");d=this.$node.find(".Wl-Bc");f=this.$node.find(".Wl-Cm");d.on("blur.tt",function(a){var c,f;c=document.activeElement;f=b.is(c);
c=0<b.has(c).length;e.isMsie()&&(f||c)&&(a.preventDefault(),a.stopImmediatePropagation(),e.defer(function(){d.focus()}))});b.on("mousedown.tt",function(a){a.preventDefault()});this.eventBus=a.eventBus||new M({el:d});this.dropdown=(new S({menu:b,datasets:a.datasets})).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",
this._onDatasetRendered,this);this.input=(new N({input:d,hint:f})).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",
this._onWhitespaceChanged,this);this._setLanguageDirection()}function k(b,d){var e,k,m,r;e=g(b);k=g(E).css(w);m=g(F).css(z);r=e.clone().css(x).css(f(e));r.val("").removeData().addClass("Wl-Cm").removeAttr("id name placeholder").prop("disabled",!0).attr({autocomplete:"off",spellcheck:"false"});e.data(a,{dir:e.attr("dir"),autocomplete:e.attr("autocomplete"),spellcheck:e.attr("spellcheck"),style:e.attr("style")});e.addClass("Wl-Bc").attr({autocomplete:"off",spellcheck:!1}).css(d?s:y);try{!e.attr("dir")&&
e.attr("dir","auto")}catch(n){}return e.wrap(k).parent().prepend(d?r:null).append(m)}function f(a){return{backgroundAttachment:a.css("background-attachment"),backgroundClip:a.css("background-clip"),backgroundColor:a.css("background-color"),backgroundImage:a.css("background-image"),backgroundOrigin:a.css("background-origin"),backgroundPosition:a.css("background-position"),backgroundRepeat:a.css("background-repeat"),backgroundSize:a.css("background-size")}}function d(b){var d=b.find(".Wl-Bc");e.each(d.data(a),
function(a,b){e.isUndefined(a)?d.removeAttr(b):d.attr(b,a)});d.detach().removeData(a).removeClass("Wl-Bc").insertAfter(b);b.remove()}var a="ttAttrs";e.mixin(b.prototype,{_onSuggestionClicked:function(a,b){var d;(d=this.dropdown.getDatumForSuggestion(b))&&this._select(d)},_onCursorMoved:function(){var a=this.dropdown.getDatumForCursor();this.input.setInputValue(a.value,!0);this.eventBus.trigger("cursorchanged",a.raw,a.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue();this._updateHint()},
_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint();this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint();this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0;this.dropdown.open()},_onBlurred:function(){this.isActivated=!1;this.dropdown.empty();this.dropdown.close()},_onEnterKeyed:function(a,b){var d,e;d=this.dropdown.getDatumForCursor();e=this.dropdown.getDatumForTopSuggestion();d?(this._select(d),b.preventDefault()):
this.autoselect&&e&&(this._select(e),b.preventDefault())},_onTabKeyed:function(a,b){var d;(d=this.dropdown.getDatumForCursor())?(this._select(d),b.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close();this.input.resetInputValue()},_onUpKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorUp();this.dropdown.open()},_onDownKeyed:function(){var a=this.input.getQuery();this.dropdown.isEmpty&&
a.length>=this.minLength?this.dropdown.update(a):this.dropdown.moveCursorDown();this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(a,b){this.input.clearHintIfInvalid();b.length>=this.minLength?this.dropdown.update(b):this.dropdown.empty();this.dropdown.open();this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint();this.dropdown.open()},_setLanguageDirection:function(){var a;
this.dir!==(a=this.input.getLanguageDirection())&&(this.dir=a,this.$node.css("direction",a),this.dropdown.setLanguageDirection(a))},_updateHint:function(){var a,b,d;(a=this.dropdown.getDatumForTopSuggestion())&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(b=this.input.getInputValue(),d=N.normalizeQuery(b),d=e.escapeRegExChars(d),d=RegExp("^(?:"+d+")(.+$)","i"),(a=d.exec(a.value))?this.input.setHint(b+a[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(a){var b,d;
b=this.input.getHint();d=this.input.getQuery();a=a||this.input.isCursorAtEnd();b&&d!==b&&a&&((b=this.dropdown.getDatumForTopSuggestion())&&this.input.setInputValue(b.value),this.eventBus.trigger("autocompleted",b.raw,b.datasetName))},_select:function(a){this.input.setQuery(a.value);this.input.setInputValue(a.value,!0);this._setLanguageDirection();this.eventBus.trigger("selected",a.raw,a.datasetName);this.dropdown.close();e.defer(e.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},
close:function(){this.dropdown.close()},setVal:function(a){this.isActivated?this.input.setInputValue(a):(this.input.setQuery(a),this.input.setInputValue(a,!0));this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy();this.dropdown.destroy();d(this.$node);this.$node=null}});return b}();(function(){var b,k,f;b=g.fn.typeahead;k="ttTypeahead";f={initialize:function(b,a){a=e.isArray(a)?a:[].slice.call(arguments,1);b=b||{};return this.each(function(){var c=
g(this),f;e.each(a,function(a){a.highlight=!!b.highlight});f=new T({input:c,eventBus:new M({el:c}),withHint:e.isUndefined(b.hint)?!0:!!b.hint,minLength:b.minLength,autoselect:b.autoselect,datasets:a});c.data(k,f)})},open:function(){return this.each(function(){var b;(b=g(this).data(k))&&b.open()})},close:function(){return this.each(function(){var b;(b=g(this).data(k))&&b.close()})},val:function(b){function a(){var a;(a=g(this).data(k))&&a.setVal(b)}function c(a){var b;if(a=a.data(k))b=a.getVal();return b}
return arguments.length?this.each(a):c(this.first())},destroy:function(){return this.each(function(){var b=g(this),a;if(a=b.data(k))a.destroy(),b.removeData(k)})}};g.fn.typeahead=function(b){return f[b]?f[b].apply(this,[].slice.call(arguments,1)):f.initialize.apply(this,arguments)};g.fn.typeahead.noConflict=function(){g.fn.typeahead=b;return this}})()})(window.jQuery);
